From: Yaroslav Halchenko <debian@onerussian.com>
Subject: use system-wide joblib and do not attempt to install joblib/test

 Relies on DFSG-ed sources with no joblib present

--- a/sklearn/externals/setup.py
+++ b/sklearn/externals/setup.py
@@ -5,6 +5,5 @@ def configuration(parent_package='', top
     from numpy.distutils.misc_util import Configuration
     config = Configuration('externals', parent_package, top_path)
     config.add_subpackage('joblib')
-    config.add_subpackage('joblib/test')
 
     return config
--- /dev/null
+++ b/sklearn/externals/joblib/__init__.py
@@ -0,0 +1,3 @@
+# yoh: use system-wide joblib
+
+from joblib import *
--- a/sklearn/metrics/pairwise.py
+++ b/sklearn/metrics/pairwise.py
@@ -48,7 +48,7 @@ from ..utils.validation import array2d
 from ..preprocessing import normalize
 from ..externals.joblib import Parallel
 from ..externals.joblib import delayed
-from ..externals.joblib.parallel import cpu_count
+from ..externals.joblib import parallel
 
 from .pairwise_fast import _chi2_kernel_fast
 
@@ -553,7 +553,7 @@ def _parallel_pairwise(X, Y, func, n_job
     """Break the pairwise matrix in n_jobs even slices
     and compute them in parallel"""
     if n_jobs < 0:
-        n_jobs = max(cpu_count() + 1 + n_jobs, 1)
+        n_jobs = max(parallel.cpu_count() + 1 + n_jobs, 1)
 
     if Y is None:
         Y = X
