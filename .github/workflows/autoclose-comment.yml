name: autoclose comment
# Post comment on PRs when labeled with "autoclose".

permissions:
  contents: read
  pull-requests: write

on:
  pull_request_target:
    types:
      - labeled

env:
  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
  GH_REPO: ${{ github.repository }}
  PULL_REQUEST_NUMBER: ${{ github.event.pull_request.number }}

jobs:

  post_comment:
    name: post_comment
    if: github.event.label.name == 'autoclose'
    runs-on: ubuntu-latest

    steps:

      - name: comment on potential autoclose
        run: |
          gh api \
          --method POST \
          -H "Accept: application/vnd.github+json" \
          -H "X-GitHub-Api-Version: 2022-11-28" \
          /repos/$GH_REPO/issues/$PULL_REQUEST_NUMBER/comments \
          -f "body=$BODY"
        env:
          BODY: >
            ‚è∞ This pull request might be automatically closed in two weeks from now.


            Thank you for your contribution to scikit-learn and for the effort you have
            put into this PR. This pull request does not yet meet the quality and
            clarity needed for an effective review. Project maintainers have limited
            time for code reviews, and thus our goal is to prioritize well-prepared
            contributions to keep scikit-learn maintainable.


            As the author, you are responsible for driving this PR, which entails
            presenting its context and your approach, fixing test failures, answering
            questions and doing additional research if requested. If all that sounds
            demanding, that's because it is, and if you are a [new
            contributor](https://scikit-learn.org/dev/developers/contributing.html#new-contributors),
            we recommend you try other contribution types for first (like reviewing
            other contributor's PRs) before attempting to submit code.


            To avoid autoclose on this PR and increase the chance of a productive
            review, please refer to: [How do I improve my issue or pull
            request?](https://scikit-learn.org/dev/faq.html#how-do-i-improve-my-issue-or-pull-request)


            Scikit-learn maintainers cannot provide one-to-one guidance to improve this
            PR. However, as a community that values helpful discussions, we encourage
            you to ask focused questions when you are stuck (e.g., on a test failure)
            that show you have tried to investigate the problem on your own. If you
            engage genuinely (no pushing AI-generated comments or code without
            understanding) a community member may offer pointers. üí¨


            If you substantially improve your PR to address the quality concerns within
            two weeks, a maintainer may remove the `autoclose` label during their
            regular review process. Small edits or incomplete fixes are not sufficient.
            Maintainers will assess improvements on their own schedule. Please do not
            request label removal.
